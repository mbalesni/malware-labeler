#!/Users/macbook/anaconda3/bin/python

import os, sys 
import math

def list_files(dir_name, extension = None):
    paths = []
    for root, _, files in os.walk(dir_name):
        for f in files:
            if (extension is not None and extension in f) or (extension is None):
                paths.append(os.path.join(root, f))
    return paths

if __name__ == '__main__':
    directory = sys.argv[1] 
    batch_size = int(sys.argv[2])

    files = list_files(directory)

    total_files = len(files)

    total_batches = math.ceil(total_files / batch_size) 

    for batch in range(total_batches):
        start = batch * batch_size
        end = min((batch+1) * batch_size, total_files)

        folder_name = 'batches/batch_' + str(batch)

        os.makedirs(folder_name)

        for file_name in files[start:end]:
            command = 'cp ' + file_name + ' ' + folder_name + '/'
            os.system(command) # call shell command

        command = 'zip -qqr ' + folder_name + '.zip ' + folder_name
        os.system(command) # call shell command



    
